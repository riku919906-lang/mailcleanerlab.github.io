<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mail Cleaner Lab â€“ Gmail æ•´ç†ãƒ„ãƒ¼ãƒ« | automaker-hub</title>

  <style>
    /* ===================== */
    /*   åŸºæœ¬ãƒ†ãƒ¼ãƒ          */
    /* ===================== */
    :root {
      --bg: #0f172a;
      --card-bg: #020617;
      --accent: #22c55e;
      --accent-soft: rgba(34, 197, 94, 0.15);
      --border: #1f2937;
      --text-main: #e5e7eb;
      --text-sub: #9ca3af;
      --danger: #ef4444;
      --danger-soft: rgba(239, 68, 68, 0.15);
      --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.8);
      --radius-lg: 18px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1f2937 0, #020617 55%, #000 100%);
      color: var(--text-main);
      min-height: 100vh;
    }

    .page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px 16px 40px;
    }

    /* ===================== */
    /*   ãƒ˜ãƒƒãƒ€ãƒ¼             */
    /* ===================== */
    header {
      padding: 8px 0 16px;
    }

    .headline {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
    }

    .headline-left h1 {
      margin: 0 0 4px;
      font-size: 1.4rem;
      letter-spacing: 0.03em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .headline-left h1 .badge {
      font-size: 0.7rem;
      padding: 2px 6px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      color: var(--text-sub);
    }

    .headline-left p {
      margin: 0;
      font-size: 0.82rem;
      color: var(--text-sub);
    }

    .headline-right {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .pill {
      font-size: 0.7rem;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      color: var(--text-sub);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .pill strong {
      color: var(--accent);
    }

    /* å•ã„åˆã‚ã›ãƒœã‚¿ãƒ³ */
    .btn-contact {
      padding: 8px 14px;
      background: rgba(30, 31, 41, 0.9);
      border: 1px solid #3a3b45;
      border-radius: 10px;
      color: #e4e4e7;
      font-size: 0.82rem;
      text-decoration: none;
      transition: 0.2s;
      display: inline-flex;
      align-items: center;
    }

    .btn-contact:hover {
      background: rgba(46, 47, 56, 0.9);
      border-color: #4b4c58;
    }

    /* OAuth ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ */
    .auth-area {
      margin-top: 12px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .btn-auth {
      padding: 8px 14px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.85rem;
      font-weight: 600;
      background: linear-gradient(135deg, var(--accent), #16a34a);
      color: #000;
      box-shadow: 0 10px 30px rgba(34, 197, 94, 0.45);
    }

    .btn-auth.secondary {
      background: transparent;
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--text-sub);
      box-shadow: none;
    }

    .btn-auth .icon {
      font-size: 1.1rem;
    }

    .pill-mini {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 0.7rem;
      border: 1px solid rgba(55, 65, 81, 0.8);
      color: var(--text-sub);
    }

    .pill-mini .dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #6b7280;
      transition: background 0.15s, box-shadow 0.15s;
    }

    .pill-mini .dot.on {
      background: #22c55e;
      box-shadow: 0 0 10px rgba(34, 197, 94, 0.9);
    }

    .pill-mini .dot.off {
      background: #f97316;
      box-shadow: none;
    }

    /* ===================== */
    /*   ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ     */
    /* ===================== */
    .layout {
      display: flex;
      gap: 18px;
      margin-top: 16px;
      align-items: flex-start;
    }

    .card {
      background: radial-gradient(circle at top left, #111827 0, #020617 40%, #000 100%);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(55, 65, 81, 0.7);
      box-shadow: var(--shadow-soft);
      padding: 16px 18px;
      flex: 1;
      min-width: 0;
    }

    .card h2 {
      margin-top: 0;
      font-size: 1rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .card h2 .dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 12px rgba(34, 197, 94, 0.9);
    }

    .card .desc {
      margin: 6px 0 14px;
      font-size: 0.78rem;
      color: var(--text-sub);
      line-height: 1.5;
    }

    .section-label {
      font-size: 0.8rem;
      font-weight: 600;
      margin: 10px 0 4px;
      color: var(--text-sub);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .section-label .bar {
      display: inline-block;
      width: 3px;
      height: 14px;
      border-radius: 999px;
      background: linear-gradient(to bottom, var(--accent), transparent);
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid rgba(75, 85, 99, 0.9);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-main);
      font-size: 0.85rem;
      outline: none;
      transition: border 0.15s, box-shadow 0.15s, background 0.15s;
      font-family: inherit;
    }

    input::placeholder,
    textarea::placeholder {
      color: #6b7280;
    }

    input:focus,
    textarea:focus,
    select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.5);
      background: rgba(15, 23, 42, 0.98);
    }

    textarea {
      resize: vertical;
      min-height: 70px;
    }

    .row-two {
      display: flex;
      gap: 8px;
    }

    .row-two > div {
      flex: 1;
    }

    .preset {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 10px;
    }

    .preset button {
      border-radius: 999px;
      border: 1px solid rgba(75, 85, 99, 0.9);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-sub);
      font-size: 0.75rem;
      padding: 4px 10px;
      cursor: pointer;
      transition: background 0.15s, color 0.15s, border 0.15s, transform 0.1s;
    }

    .preset button:hover {
      background: rgba(34, 197, 94, 0.08);
      border-color: var(--accent);
      color: var(--accent);
      transform: translateY(-1px);
    }

    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    .btn-main,
    .btn-secondary,
    .btn-danger,
    .btn-ghost {
      flex: 1;
      min-width: 120px;
      border-radius: 999px;
      padding: 8px 10px;
      font-size: 0.86rem;
      font-weight: 600;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: transform 0.08s ease-out, box-shadow 0.15s, background 0.15s, opacity 0.15s;
      white-space: nowrap;
    }

    .btn-main {
      background: linear-gradient(135deg, var(--accent), #22c55e);
      color: #000;
      box-shadow: 0 14px 30px rgba(34, 197, 94, 0.45);
    }

    .btn-secondary {
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: var(--text-sub);
    }

    .btn-danger {
      background: linear-gradient(135deg, var(--danger), #b91c1c);
      color: #fee2e2;
      box-shadow: 0 14px 30px rgba(239, 68, 68, 0.4);
    }

    .btn-ghost {
      background: transparent;
      border: 1px dashed rgba(75, 85, 99, 0.8);
      color: var(--text-sub);
    }

    .btn-main:hover,
    .btn-secondary:hover,
    .btn-danger:hover,
    .btn-ghost:hover {
      transform: translateY(-1px);
      box-shadow: 0 18px 36px rgba(0, 0, 0, 0.6);
      opacity: 0.95;
    }

    .btn-main .icon,
    .btn-secondary .icon,
    .btn-danger .icon {
      font-size: 1rem;
    }

    select {
      background-image: linear-gradient(45deg, transparent 50%, #9ca3af 50%),
                        linear-gradient(135deg, #9ca3af 50%, transparent 50%);
      background-position: calc(100% - 14px) 50%, calc(100% - 9px) 50%;
      background-size: 5px 5px, 5px 5px;
      background-repeat: no-repeat;
      appearance: none;
    }

    .result-block {
      background: radial-gradient(circle at top left, rgba(34, 197, 94, 0.1), transparent 55%);
      border-radius: 14px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      padding: 10px 12px;
      margin-bottom: 10px;
    }

    .result-block.danger {
      background: radial-gradient(circle at top left, var(--danger-soft), transparent 55%);
      border-color: rgba(153, 27, 27, 0.9);
    }

    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 6px;
    }

    .result-header .title {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--text-sub);
    }

    .result-header .counter {
      font-size: 0.75rem;
      color: var(--text-sub);
    }

    .ad-slot {
      margin-top: 14px;
      padding: 12px;
      border-radius: 14px;
      border: 1px dashed rgba(75, 85, 99, 0.9);
      background: radial-gradient(circle at top left, rgba(59, 130, 246, 0.16), transparent 60%);
      font-size: 0.78rem;
      color: var(--text-sub);
    }

    .ad-slot strong {
      color: #93c5fd;
    }

    footer {
      margin-top: 16px;
      font-size: 0.7rem;
      color: #6b7280;
      text-align: right;
    }

    /* ã‚¹ãƒãƒ›å¯¾å¿œ */
    @media (max-width: 768px) {
      .page {
        padding: 12px 10px 30px;
      }

      .layout {
        flex-direction: column;
      }

      .card {
        padding: 14px 14px 16px;
      }

      .headline {
        gap: 8px;
      }

      .headline-right {
        justify-content: flex-start;
      }

      .button-row {
        flex-direction: column;
      }

      .btn-main,
      .btn-secondary,
      .btn-danger,
      .btn-ghost {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="headline">
        <div class="headline-left">
          <h1>
            Gmail æ•´ç†ãƒ„ãƒ¼ãƒ«
            <span class="badge">Mail Cleaner Lab / automaker-hub</span>
          </h1>
          <p>ã„ã‚‰ãªã„ãƒ¡ãƒ¼ãƒ«ã‚’ä¸€æ°—ã«æ•´ç†ã€‚æ¤œç´¢æ¡ä»¶ã‚’è‡ªå‹•ç”Ÿæˆã—ã¦ã€å‰Šé™¤ãƒ»ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ»æ—¢èª­åŒ–ã¾ã§ã¾ã¨ã‚ã¦å®Ÿè¡Œã—ã¾ã™ã€‚</p>
        </div>
        <div class="headline-right">
          <span class="pill">
            Gmail ç”¨ãƒ„ãƒ¼ãƒ« / <strong>åç›ŠåŒ–å¯¾å¿œãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</strong>
          </span>
          <a href="contact.html" class="btn-contact">ãŠå•ã„åˆã‚ã›</a>
        </div>
      </div>

      <!-- OAuth ãƒœã‚¿ãƒ³ -->
      <div class="auth-area">
        <button id="oauth-btn" class="btn-auth">
          <span class="icon">ğŸ”</span>
          Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé€£æºï¼ˆOAuthï¼‰
        </button>
        <button id="btn-signout" class="btn-auth secondary">
          <span class="icon">ğŸšª</span>
          åˆ‡æ–­ / ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆ
        </button>
        <span class="pill-mini" id="auth-status">
          <span class="dot off" id="auth-dot"></span> ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: æœªé€£æº
        </span>
      </div>
    </header>

    <main class="layout">
      <!-- å·¦å´ï¼šæ¡ä»¶è¨­å®šã‚¨ãƒªã‚¢ -->
      <section class="card" aria-label="æ¡ä»¶è¨­å®š">
        <h2>
          <span class="dot"></span>
          æ¤œç´¢æ¡ä»¶ã®è¨­å®š
        </h2>
        <p class="desc">
          å‰Šé™¤ãƒ»ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ»æ—¢èª­åŒ–ã—ãŸã„ãƒ¡ãƒ¼ãƒ«ã®æ¡ä»¶ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚<br />
          ä¸‹ã®ã€Œãƒ—ãƒªã‚»ãƒƒãƒˆã€ã‹ã‚‰ã€ã‚ˆãä½¿ã†ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒ¯ãƒ³ã‚¿ãƒƒãƒ—ã§å‘¼ã³å‡ºã›ã¾ã™ã€‚
        </p>

        <div class="section-label">
          <span class="bar"></span> ã‚ˆãä½¿ã†ãƒ—ãƒªã‚»ãƒƒãƒˆ
        </div>
        <div class="preset">
          <button type="button" data-preset="rakuten">æ¥½å¤©ç³»ãƒ¡ãƒ¼ãƒ«</button>
          <button type="button" data-preset="amazon">Amazoné€šçŸ¥</button>
          <button type="button" data-preset="promo">åºƒå‘Šï¼ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³</button>
          <button type="button" data-preset="magazine">ãƒ¡ãƒ«ãƒã‚¬å…¨èˆ¬</button>
          <button type="button" data-preset="old-promo">30æ—¥ã‚ˆã‚Šå‰ã®ãƒ—ãƒ­ãƒ¢</button>
        </div>

        <div class="section-label">
          <span class="bar"></span> é€ä¿¡å…ƒï¼ˆfromï¼‰
        </div>
        <input id="from-input" type="text" placeholder="ä¾‹ï¼šnews@rakuten.co.jp / @example.com" />

        <div class="section-label">
          <span class="bar"></span> ä»¶åã«å«ã¾ã‚Œã‚‹è¨€è‘‰
        </div>
        <input id="subject-input" type="text" placeholder="ä¾‹ï¼šãƒ¡ãƒ«ãƒã‚¬, ã‚¯ãƒ¼ãƒãƒ³" />

        <div class="section-label">
          <span class="bar"></span> æœ¬æ–‡ã«å«ã¾ã‚Œã‚‹è¨€è‘‰
        </div>
        <input id="body-input" type="text" placeholder="ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§è¤‡æ•°å¯" />

        <div class="section-label">
          <span class="bar"></span> é™¤å¤–ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
        </div>
        <input id="exclude-input" type="text" placeholder="é‡è¦ãªé€šçŸ¥ãªã©é™¤å¤–ã—ãŸã„å ´åˆ" />

        <div class="row-two">
          <div>
            <div class="section-label">
              <span class="bar"></span> ã„ã¤ä»¥é™ã®ãƒ¡ãƒ¼ãƒ«
            </div>
            <input id="after-input" type="text" placeholder="ä¾‹ï¼š7d / 2024-01-01" />
          </div>
          <div>
            <div class="section-label">
              <span class="bar"></span> ã„ã¤ä»¥å‰ã®ãƒ¡ãƒ¼ãƒ«
            </div>
            <input id="before-input" type="text" placeholder="ä¾‹ï¼š30d / 2023-12-31" />
          </div>
        </div>

        <div class="section-label">
          <span class="bar"></span> ç”Ÿæˆã•ã‚ŒãŸæ¤œç´¢æ¡ä»¶ï¼ˆç·¨é›†å¯èƒ½ï¼‰
        </div>
        <textarea id="query-text" rows="4" placeholder="ã“ã“ã«æ¤œç´¢æ¡ä»¶ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™"></textarea>

        <div class="section-label">
          <span class="bar"></span> å®Ÿè¡Œã™ã‚‹æ“ä½œ
        </div>
        <select id="action-select">
          <option value="trash">ã‚´ãƒŸç®±ã¸ç§»å‹•ï¼ˆå‰Šé™¤ï¼‰</option>
          <option value="archive">ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–</option>
          <option value="read">æ—¢èª­ã«ã™ã‚‹</option>
        </select>

        <div class="button-row">
          <button id="btn-generate" class="btn-main">
            <span class="icon">âœ¨</span> æ¡ä»¶ã‚’ä½œæˆ
          </button>
          <button id="btn-preview" class="btn-secondary">
            <span class="icon">ğŸ”</span> ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
          </button>
          <button id="btn-execute" class="btn-danger">
            <span class="icon">âš ï¸</span> æœ¬ç•ªå®Ÿè¡Œ
          </button>
        </div>
      </section>

      <!-- å³å´ï¼šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ / å®Ÿè¡Œçµæœã‚¨ãƒªã‚¢ -->
      <section class="card" aria-label="å®Ÿè¡Œçµæœ">
        <h2>
          <span class="dot"></span>
          ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨å®Ÿè¡Œçµæœ
        </h2>
        <p class="desc">
          å®Ÿè¡Œå‰ã«å¿…ãšãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ã€æœ¬å½“ã«æ¶ˆã—ã¦ã‚ˆã„ãƒ¡ãƒ¼ãƒ«ã ã‘ãŒå¯¾è±¡ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚
        </p>

        <div class="result-block">
          <div class="result-header">
            <span class="title">ç¾åœ¨ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</span>
            <span class="counter" id="preview-count-label">å¯¾è±¡ä»¶æ•°: - ä»¶</span>
          </div>
          <textarea id="preview-text" rows="6" placeholder="ã€Œæ¡ä»¶ã‚’ä½œæˆ â†’ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€ã®é †ã«æ“ä½œã™ã‚‹ã¨ã€ã“ã“ã« Gmail API ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚"></textarea>
        </div>

        <div class="result-block danger">
          <div class="result-header">
            <span class="title">å®Ÿè¡Œçµæœãƒ­ã‚°ï¼ˆGmail API ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼‰</span>
            <span class="counter" id="result-count-label">æœ€çµ‚ä»¶æ•°: - ä»¶</span>
          </div>
          <textarea id="result-text" rows="6" placeholder="ã€Œæœ¬ç•ªå®Ÿè¡Œã€ã‚’æŠ¼ã™ã¨ã€ã“ã“ã« Gmail API ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å…¨ä½“ãŒãƒ­ã‚°ã¨ã—ã¦ä¿å­˜ã•ã‚Œã¾ã™ã€‚"></textarea>
        </div>

        <div class="button-row">
          <button id="btn-clear-result" class="btn-ghost">
            å®Ÿè¡Œçµæœãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢
          </button>
        </div>

        <!-- åºƒå‘Šã‚¹ãƒ­ãƒƒãƒˆ 1 -->
        <div class="ad-slot">
          <strong>åºƒå‘Šã‚¹ãƒ­ãƒƒãƒˆ Aï¼ˆä¸Šéƒ¨ï¼‰</strong><br />
          ã“ã“ã«ãƒãƒŠãƒ¼åºƒå‘Šã‚„ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆãƒªãƒ³ã‚¯ã‚’è¨­ç½®ã§ãã¾ã™ã€‚<br />
          ä¾‹ï¼šæœ‰æ–™ç‰ˆã€Œè‡ªå‹•æ¯æ—¥ã‚¯ãƒªãƒ¼ãƒ³ã€ã¸ã®å°ç·šã‚„ã€ãƒ¡ãƒ¼ãƒ«æ•´ç†ãƒã‚¦ãƒã‚¦è¨˜äº‹ã¸ã®ãƒªãƒ³ã‚¯ãªã©ã€‚
        </div>

        <!-- åºƒå‘Šã‚¹ãƒ­ãƒƒãƒˆ 2 -->
        <div class="ad-slot">
          <strong>åºƒå‘Šã‚¹ãƒ­ãƒƒãƒˆ Bï¼ˆä¸­æ®µï¼‰</strong><br />
          ãƒ»Gmail æ•´ç†ä»£è¡Œã‚µãƒ¼ãƒ“ã‚¹<br />
          ãƒ»ã‚ªãƒ³ãƒ©ã‚¤ãƒ³è¬›åº§ / note è¨˜äº‹ã¸ã®å°ç·š<br />
          ãƒ»åˆ¥ãƒ„ãƒ¼ãƒ«ï¼ˆiCloud ç‰ˆ / ä»•äº‹ç”¨ç‰ˆï¼‰ã¸ã®ãƒªãƒ³ã‚¯
        </div>

        <!-- åºƒå‘Šã‚¹ãƒ­ãƒƒãƒˆ 3 -->
        <div class="ad-slot">
          <strong>åºƒå‘Šã‚¹ãƒ­ãƒƒãƒˆ Cï¼ˆãƒ•ãƒƒã‚¿ãƒ¼æ¨ªï¼‰</strong><br />
          å°ã•ã‚ãƒ†ã‚­ã‚¹ãƒˆãƒªãƒ³ã‚¯åºƒå‘Šã‚„ã€ã‚¯ãƒ¼ãƒãƒ³ã‚³ãƒ¼ãƒ‰ã€ç´¹ä»‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãªã©ã‚’é…ç½®ã™ã‚‹æƒ³å®šã‚¹ãƒšãƒ¼ã‚¹ã§ã™ã€‚
        </div>
      </section>
    </main>

    <footer>
      Mail Cleaner Lab â€“ Gmail è‡ªå‹•æ•´ç†ãƒ„ãƒ¼ãƒ«ï¼ˆautomaker-hub ç‰ˆï¼‰
    </footer>
  </div>

  <!-- ===================== -->
  <!--   JavaScript éƒ¨åˆ†      -->
  <!-- ===================== -->
  <script>
    // ====== OAuth è¨­å®š ======
    const CLIENT_ID =
      "923017588150-th43jikkldliggrt258aqg95hrk2ob73.apps.googleusercontent.com";
    const REDIRECT_URI = "https://automaker-hub.github.io/";
    const SCOPES = "https://www.googleapis.com/auth/gmail.modify";

    const API_BASE = "https://gmail.googleapis.com/gmail/v1/users/me";

    const authStatusEl = document.getElementById("auth-status");

    function setAuthStatus(connected) {
      if (!authStatusEl) return;
      authStatusEl.innerHTML =
        '<span class="dot ' +
        (connected ? "on" : "off") +
        '" id="auth-dot"></span> ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ' +
        (connected ? "é€£æºæ¸ˆã¿ âœ”" : "æœªé€£æº");
    }

    // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ï¼ˆlocalStorageï¼‰
    function getStoredToken() {
      const token = localStorage.getItem("gmail_token");
      setAuthStatus(!!token);
      return token;
    }

    // Google OAuth é–‹å§‹
    function loginWithGoogle() {
      const url =
        "https://accounts.google.com/o/oauth2/v2/auth" +
        "?client_id=" +
        encodeURIComponent(CLIENT_ID) +
        "&redirect_uri=" +
        encodeURIComponent(REDIRECT_URI) +
        "&response_type=token" +
        "&scope=" +
        encodeURIComponent(SCOPES) +
        "&include_granted_scopes=true" +
        "&prompt=consent";

      window.location.href = url;
    }

    document
      .getElementById("oauth-btn")
      .addEventListener("click", loginWithGoogle);

    // ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆ
    document.getElementById("btn-signout").addEventListener("click", () => {
      localStorage.removeItem("gmail_token");
      setAuthStatus(false);
      alert("ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ã•ã‚Œã¦ã„ãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’å‰Šé™¤ã—ã¾ã—ãŸï¼‰");
    });

    // URL ãƒãƒƒã‚·ãƒ¥ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æŠ½å‡º
    function extractAccessToken() {
      const hash = window.location.hash.substring(1);
      if (hash) {
        const params = new URLSearchParams(hash);
        const token = params.get("access_token");
        if (token) {
          localStorage.setItem("gmail_token", token);
          setAuthStatus(true);
          console.log("Google OAuth æˆåŠŸï¼ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜ã—ã¾ã—ãŸ");
          // ãƒãƒƒã‚·ãƒ¥ã‚’URLã‹ã‚‰æ¶ˆã—ã¦è¦‹ãŸç›®ã‚’ã‚­ãƒ¬ã‚¤ã«
          history.replaceState(
            null,
            "",
            window.location.pathname + window.location.search
          );
          return;
        }
      }
      // æ—¢ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹å ´åˆ
      getStoredToken();
    }

    extractAccessToken();

    // å…±é€šï¼šGmail API ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    async function gmailRequest(path, options = {}) {
      const token = getStoredToken();
      if (!token) {
        throw new Error(
          "Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ã¾ã é€£æºã—ã¦ã„ã¾ã›ã‚“ã€‚ã€ŒGoogle ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé€£æºã€ãƒœã‚¿ãƒ³ã‹ã‚‰èªå¯ã—ã¦ãã ã•ã„ã€‚"
        );
      }

      const res = await fetch(API_BASE + path, {
        ...options,
        headers: {
          Authorization: "Bearer " + token,
          Accept: "application/json",
          ...(options.headers || {}),
        },
      });

      if (!res.ok) {
        const text = await res.text();
        throw new Error("HTTP " + res.status + " : " + text);
      }

      if (res.status === 204) {
        return {};
      }

      return res.json();
    }

    // ==========================
    // Gmail æ¤œç´¢ãƒ„ãƒ¼ãƒ«å´ã®å‡¦ç†
    // ==========================
    const queryTextEl = document.getElementById("query-text");
    const previewTextEl = document.getElementById("preview-text");
    const resultTextEl = document.getElementById("result-text");
    const previewCountLabel = document.getElementById("preview-count-label");
    const resultCountLabel = document.getElementById("result-count-label");

    // æ¤œç´¢æ¡ä»¶ã‚’çµ„ã¿ç«‹ã¦
    function buildGmailQuery() {
      const from = document.getElementById("from-input").value.trim();
      const subject = document.getElementById("subject-input").value.trim();
      const body = document.getElementById("body-input").value.trim();
      const exclude = document.getElementById("exclude-input").value.trim();
      const after = document.getElementById("after-input").value.trim();
      const before = document.getElementById("before-input").value.trim();

      const parts = [];

      if (from) {
        parts.push(`from:(${from})`);
      }
      if (subject) {
        parts.push(`subject:(${subject})`);
      }
      if (body) {
        parts.push(`{${body}}`);
      }
      if (exclude) {
        parts.push(`-{${exclude}}`);
      }
      if (after) {
        parts.push(`after:${after}`);
      }
      if (before) {
        parts.push(`before:${before}`);
      }

      return parts.join(" ");
    }

    // ãƒ—ãƒªã‚»ãƒƒãƒˆé©ç”¨
    function applyPreset(key) {
      const fromInput = document.getElementById("from-input");
      const subjectInput = document.getElementById("subject-input");
      const bodyInput = document.getElementById("body-input");
      const excludeInput = document.getElementById("exclude-input");
      const afterInput = document.getElementById("after-input");
      const beforeInput = document.getElementById("before-input");

      // ä¸€æ—¦ãƒªã‚»ãƒƒãƒˆ
      fromInput.value = "";
      subjectInput.value = "";
      bodyInput.value = "";
      excludeInput.value = "";
      afterInput.value = "";
      beforeInput.value = "";

      switch (key) {
        case "rakuten":
          fromInput.value = "@rakuten.co.jp";
          subjectInput.value = "ãƒã‚¤ãƒ³ãƒˆ, ãŠå¾—, ã‚»ãƒ¼ãƒ«";
          break;
        case "amazon":
          fromInput.value = "@amazon.co.jp";
          subjectInput.value = "ãŠã™ã™ã‚, ã‚»ãƒ¼ãƒ«, ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³";
          break;
        case "promo":
          bodyInput.value = "ã‚»ãƒ¼ãƒ«, ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³, åºƒå‘Š";
          break;
        case "magazine":
          subjectInput.value = "ãƒ¡ãƒ«ãƒã‚¬, newsletter";
          break;
        case "old-promo":
          bodyInput.value = "ã‚»ãƒ¼ãƒ«, ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³, åºƒå‘Š";
          beforeInput.value = "30d";
          break;
      }

      const query = buildGmailQuery();
      queryTextEl.value = query;
    }

    // æ¤œç´¢æ¡ä»¶ã‚’è‡ªå‹•ç”Ÿæˆ
    function handleGenerateQuery() {
      const query = buildGmailQuery();
      queryTextEl.value = query;
      if (!query) {
        alert(
          "æ¤œç´¢æ¡ä»¶ãŒç©ºã§ã™ã€‚é€ä¿¡å…ƒã‚„ä»¶åãªã©ã‚’å…¥åŠ›ã—ã¦ã‹ã‚‰ã€Œæ¡ä»¶ã‚’ä½œæˆã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚"
        );
      }
    }

    // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆæœ¬ç‰©ã® Gmail APIï¼‰
    async function handlePreview() {
      const query = queryTextEl.value.trim() || buildGmailQuery();
      if (!query) {
        alert(
          "æ¤œç´¢æ¡ä»¶ãŒç©ºã§ã™ã€‚ã€Œæ¡ä»¶ã‚’ä½œæˆã€ã‚’æŠ¼ã™ã‹ã€æ¡ä»¶ã‚’ç›´æ¥å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"
        );
        return;
      }

      previewCountLabel.textContent = "å¯¾è±¡ä»¶æ•°: å–å¾—ä¸­...";
      previewTextEl.value =
        "Gmail API ã«å•ã„åˆã‚ã›ä¸­ã§ã™...\n\næ¤œç´¢æ¡ä»¶: " + query + "\n";

      try {
        const data = await gmailRequest(
          "/messages?q=" + encodeURIComponent(query) + "&maxResults=50"
        );

        const count =
          typeof data.resultSizeEstimate === "number"
            ? data.resultSizeEstimate
            : (data.messages || []).length;

        previewCountLabel.textContent =
          "å¯¾è±¡ä»¶æ•°ï¼ˆæ¨å®šï¼‰: " + count.toString() + " ä»¶";

        previewTextEl.value =
          "ã€Gmail API ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€‘\n" +
          "æ¤œç´¢æ¡ä»¶: " +
          query +
          "\n\n" +
          "resultSizeEstimate: " +
          count +
          " ä»¶\n" +
          "maxResults=50 ã§å–å¾—ã—ãŸ 1 ãƒšãƒ¼ã‚¸ç›®ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹:\n\n" +
          JSON.stringify(data, null, 2);
      } catch (err) {
        console.error(err);
        previewCountLabel.textContent = "å¯¾è±¡ä»¶æ•°: å–å¾—å¤±æ•—";
        previewTextEl.value =
          "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚\n\n" + (err && err.message ? err.message : err);
      }
    }

    function buildBatchBody(action, ids) {
      const body = {
        ids,
        addLabelIds: [],
        removeLabelIds: [],
      };

      switch (action) {
        case "trash":
          // TRASH ãƒ©ãƒ™ãƒ«ã‚’ä»˜ã‘ã‚‹ = ã‚´ãƒŸç®±è¡Œã
          body.addLabelIds.push("TRASH");
          break;
        case "archive":
          // INBOX ã‚’å¤–ã™ = ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
          body.removeLabelIds.push("INBOX");
          break;
        case "read":
          // UNREAD ã‚’å¤–ã—ã¦ READ ã‚’ä»˜ã‘ã‚‹
          body.addLabelIds.push("READ");
          body.removeLabelIds.push("UNREAD");
          break;
      }

      return body;
    }

    // æœ¬ç•ªå®Ÿè¡Œ
    async function handleExecute() {
      const query = queryTextEl.value.trim() || buildGmailQuery();
      if (!query) {
        alert(
          "æ¤œç´¢æ¡ä»¶ãŒç©ºã§ã™ã€‚ã€Œæ¡ä»¶ã‚’ä½œæˆ â†’ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€ã§å†…å®¹ã‚’ç¢ºèªã—ã¦ã‹ã‚‰å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚"
        );
        return;
      }

      const action = document.getElementById("action-select").value;

      let actionLabel = "";
      if (action === "trash") actionLabel = "ã‚´ãƒŸç®±ã¸ç§»å‹•ï¼ˆå‰Šé™¤ï¼‰";
      if (action === "archive") actionLabel = "ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–";
      if (action === "read") actionLabel = "æ—¢èª­ã«ã™ã‚‹";

      const ok = confirm(
        "ã€è¶…æ³¨æ„ã€‘ã“ã®æ¡ä»¶ã§ Gmail ã«æœ¬ç•ªå®Ÿè¡Œã—ã¾ã™ã€‚\n\n" +
          "æ¤œç´¢æ¡ä»¶: " +
          query +
          "\n" +
          "æ“ä½œ: " +
          actionLabel +
          "\n\n" +
          "ã“ã®æ“ä½œã¯ Gmail ä¸Šã§å–ã‚Šæ¶ˆã—ã§ããªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚\n" +
          "æœ¬å½“ã«å®Ÿè¡Œã—ã¦ã‚ˆã‘ã‚Œã° [OK] ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚"
      );
      if (!ok) return;

      resultTextEl.value =
        "=== Gmail API æœ¬ç•ªå®Ÿè¡Œé–‹å§‹ ===\n" +
        "æ¤œç´¢æ¡ä»¶: " +
        query +
        "\n" +
        "æ“ä½œ: " +
        actionLabel +
        "\n\n";
      resultCountLabel.textContent = "æœ€çµ‚ä»¶æ•°: å®Ÿè¡Œä¸­...";

      try {
        // ã¾ãšã¯æ¡ä»¶ã«ãƒãƒƒãƒã™ã‚‹å…¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ID ã‚’å–å¾—ï¼ˆåˆ¶é™ãªã—ï¼‰
        let allIds = [];
        let pageToken = undefined;
        let page = 1;

        while (true) {
          const data = await gmailRequest(
            "/messages?q=" +
              encodeURIComponent(query) +
              "&maxResults=500" +
              (pageToken ? "&pageToken=" + encodeURIComponent(pageToken) : "")
          );

          const ids = (data.messages || []).map((m) => m.id);
          allIds = allIds.concat(ids);

          resultTextEl.value +=
            "--- list page " +
            page +
            " ---\n" +
            JSON.stringify(data, null, 2) +
            "\n\n";

          if (!data.nextPageToken) break;
          pageToken = data.nextPageToken;
          page++;
        }

        if (allIds.length === 0) {
          resultTextEl.value +=
            "è©²å½“ãƒ¡ãƒ¼ãƒ«ã¯ 0 ä»¶ã§ã—ãŸã€‚batchModify ã¯å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚\n";
          resultCountLabel.textContent = "æœ€çµ‚ä»¶æ•°: 0 ä»¶";
          return;
        }

        // å–å¾—ã—ãŸ ID ã‚’ 1000 ä»¶ãšã¤ã«åˆ†å‰²ã—ã¦ batchModify
        const BATCH_SIZE = 1000;
        let processed = 0;
        let batchIndex = 1;

        for (let i = 0; i < allIds.length; i += BATCH_SIZE) {
          const batchIds = allIds.slice(i, i + BATCH_SIZE);
          const body = buildBatchBody(action, batchIds);

          const res = await gmailRequest("/messages/batchModify", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(body),
          });

          processed += batchIds.length;

          resultTextEl.value +=
            "--- batchModify " +
            batchIndex +
            " (" +
            batchIds.length +
            " ä»¶) ---\n" +
            JSON.stringify(res, null, 2) +
            "\n\n";

          batchIndex++;
        }

        resultCountLabel.textContent =
          "æœ€çµ‚ä»¶æ•°: " + processed.toString() + " ä»¶";
        resultTextEl.value +=
          "=== å®Œäº†ã—ã¾ã—ãŸã€‚å‡¦ç†ä»¶æ•°: " +
          processed.toString() +
          " ä»¶ ===\n";
      } catch (err) {
        console.error(err);
        resultTextEl.value +=
          "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚\n\n" +
          (err && err.message ? err.message : err) +
          "\n";
        resultCountLabel.textContent = "æœ€çµ‚ä»¶æ•°: ã‚¨ãƒ©ãƒ¼";
      }
    }

    function handleClearResult() {
      resultTextEl.value = "";
      resultCountLabel.textContent = "æœ€çµ‚ä»¶æ•°: - ä»¶";
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆç´ã¥ã‘
    document
      .getElementById("btn-generate")
      .addEventListener("click", handleGenerateQuery);
    document
      .getElementById("btn-preview")
      .addEventListener("click", () => {
        handlePreview().catch((e) => console.error(e));
      });
    document
      .getElementById("btn-execute")
      .addEventListener("click", () => {
        handleExecute().catch((e) => console.error(e));
      });
    document
      .getElementById("btn-clear-result")
      .addEventListener("click", handleClearResult);

    document.querySelectorAll(".preset button").forEach((btn) => {
      btn.addEventListener("click", () => {
        const key = btn.getAttribute("data-preset");
        applyPreset(key);
      });
    });
  </script>
</body>
</html>
